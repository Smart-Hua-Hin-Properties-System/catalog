<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN | SMART PROPERTIES SYSTEM</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #1a5276; --secondary: #154360; --bg: #f4f7f6; --white: #ffffff; }
        body { font-family: 'Kanit', sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        .admin-container { max-width: 600px; margin: 0 auto; }
        
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: var(--primary); margin: 0; font-weight: 600; }
        
        .card { background: var(--white); border-radius: 25px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--primary); font-size: 0.9rem; }
        .form-group input, .form-group select, .form-group textarea { 
            width: 100%; padding: 12px 15px; border-radius: 12px; border: 1px solid #ddd; 
            font-family: 'Kanit'; font-size: 1rem; box-sizing: border-box; outline: none; transition: 0.3s;
        }
        .form-group input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(26, 82, 118, 0.1); }
        .form-group input[readonly] { background: #f8f9fa; color: #888; cursor: not-allowed; }

        .btn-submit { 
            width: 100%; padding: 15px; background: var(--primary); color: white; 
            border: none; border-radius: 15px; font-size: 1.1rem; font-weight: 600; 
            cursor: pointer; transition: 0.3s; margin-top: 10px;
        }
        .btn-submit:hover { background: var(--secondary); transform: translateY(-2px); }
        .btn-submit:disabled { background: #ccc; cursor: not-allowed; }

        .status-msg { margin-top: 20px; text-align: center; padding: 10px; border-radius: 10px; display: none; }
        .success { background: #d4edda; color: #155724; display: block; }
        .error { background: #f8d7da; color: #721c24; display: block; }
    </style>
</head>
<body>

<div class="admin-container">
    <div class="header">
        <h1><i class="fas fa-user-shield"></i> ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô</h1>
        <p>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö HOUSE_ID</p>
    </div>

    <div class="card">
        <form id="propertyForm">
            <div class="form-group">
                <label>‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∞‡∏ö‡∏ö (HP_ID) *‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</label>
                <input type="text" id="f_HP_ID" placeholder="‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" readonly>
            </div>

            <div class="form-group">
                <label>‡∏£‡∏´‡∏±‡∏™‡∏ö‡πâ‡∏≤‡∏ô / ‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á (HOUSE_ID)</label>
                <input type="text" id="f_HOUSE_ID" required placeholder="‡πÄ‡∏ä‡πà‡∏ô M40, A12, Villa-01">
            </div>

            <div class="form-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                <input type="text" id="f_Project_Name" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£">
            </div>

            <div class="form-group">
                <label>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)</label>
                <input type="number" id="f_Price" required placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 5500000">
            </div>

            <div class="form-group">
                <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
                <select id="f_District">
                    <option value="‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô">‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô</option>
                    <option value="‡∏ä‡∏∞‡∏≠‡∏≥">‡∏ä‡∏∞‡∏≠‡∏≥</option>
                    <option value="‡∏õ‡∏£‡∏≤‡∏ì‡∏ö‡∏∏‡∏£‡∏µ">‡∏õ‡∏£‡∏≤‡∏ì‡∏ö‡∏∏‡∏£‡∏µ</option>
                </select>
            </div>

            <div class="form-group">
                <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</label>
                <select id="f_Status">
                    <option value="Available">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢ (Available)</option>
                    <option value="Sold">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß (Sold)</option>
                    <option value="Pending">‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß (Pending)</option>
                </select>
            </div>

            <button type="submit" class="btn-submit" id="submitBtn">
                <i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet
            </button>
        </form>

        <div id="statusBox" class="status-msg"></div>
    </div>
    
    <div style="text-align: center; margin-top: 20px;">
        <a href="index.html" style="color: var(--primary); text-decoration: none;"><i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å</a>
    </div>
</div>

<script>
    /** ============================================================
     * üö© ‡∏ß‡∏≤‡∏á URL ‡∏Ç‡∏≠‡∏á Apps Script ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì Deploy ‡πÑ‡∏ß‡πâ‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
     * ============================================================ */
    const API_URL = "https://script.google.com/macros/s/AKfycbyS8rGtSnhVS8RdWje7icXZVCw5iBBJoWkEpOYm649OC6FOhnrVi87dD9GsJl_m_FVw/exec";

    const form = document.getElementById('propertyForm');
    const btn = document.getElementById('submitBtn');
    const statusBox = document.getElementById('statusBox');

    form.onsubmit = async (e) => {
        e.preventDefault();
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
        showStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', '');

        const payload = {
            action: "save", // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ Apps Script ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            HP_ID: document.getElementById('f_HP_ID').value,
            HOUSE_ID: document.getElementById('f_HOUSE_ID').value,
            Project_Name: document.getElementById('f_Project_Name').value,
            Price: document.getElementById('f_Price').value,
            District: document.getElementById('f_District').value,
            Status: document.getElementById('f_Status').value
        };

        try {
            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö POST ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Apps Script
            const response = await fetch(API_URL, {
                method: 'POST',
                mode: 'no-cors', // Apps Script ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ no-cors ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏≠‡∏∑‡πà‡∏ô
                cache: 'no-cache',
                body: JSON.stringify(payload)
            });

            // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å no-cors ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ json ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà Error
            showStatus('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ' + payload.HOUSE_ID + ' ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!', 'success');
            form.reset();
            
        } catch (error) {
            showStatus('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
        } finally {
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet';
        }
    };

    function showStatus(msg, type) {
        statusBox.innerText = msg;
        statusBox.className = 'status-msg ' + type;
    }
</script>

</body>
</html>
