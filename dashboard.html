<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Sovereign V14.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit'; background: #f4f7f6; margin: 0; text-align: center; }
        .header { background: #1a5276; color: white; padding: 25px; }
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; padding: 20px; }
        .stat-card { background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .val { font-size: 2.2rem; font-weight: 600; color: #1a5276; }
    </style>
</head>
<body>
<div class="header"><h2>EXECUTIVE ANALYTICS</h2></div>
<div class="stat-grid">
    <div class="stat-card"><div>มูลค่าทรัพย์รวม</div><div class="val" id="v1">฿0M</div></div>
    <div class="stat-card"><div>ยอดขายจริง (SOLD)</div><div class="val" id="v2" style="color:#2ecc71">฿0M</div></div>
    <div class="stat-card"><div>กำไรสะสม (ค่าคอมฯ)</div><div class="val" id="v3" style="color:#f1c40f">฿0</div></div>
</div>
<script>
    const api = "https://script.google.com/macros/s/AKfycbwRIkEYZj0CKFiHEbhc29mJ19kyqwymEj8_O2p4qThvjjueQ-ug07okMTFn-e0zz_4l/exec";
    async function load() {
        const r = await fetch(`${api}?action=salesSummary`);
        const d = await r.json();
        document.getElementById('v1').innerText = `฿${(d.totalValue/1000000).toFixed(1)}M`;
        document.getElementById('v2').innerText = `฿${(d.totalSoldValue/1000000).toFixed(1)}M`;
        document.getElementById('v3').innerText = `฿${d.totalCommission.toLocaleString()}`;
    }
    load();
</script>
</body>
</html>
